## üìå **1. –ß—Ç–æ —Ç–∞–∫–æ–µ PostgreSQL**

PostgreSQL ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è **–æ–±—ä–µ–∫—Ç–Ω–æ-—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –°–£–ë–î**, —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º.

**–ü–ª—é—Å—ã:**
- –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å (–º–æ–¥—É–ª–∏, —Ç–∏–ø—ã, —Ñ—É–Ω–∫—Ü–∏–∏)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ACID
- –ú–æ—â–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å JSON, CTE, –æ–∫–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- –†–µ–ø–ª–∏–∫–∞—Ü–∏—è, –ø–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ç—Ä–∏–≥–≥–µ—Ä—ã

---

## üß± **2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**

- **Process-based**: –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- **shared_buffers**: –∫—ç—à
- **WAL (Write-Ahead Log)**: –∂—É—Ä–Ω–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
- **background writer, checkpointer** ‚Äî —Ñ–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã

---

## üß† **3. –û—Å–Ω–æ–≤—ã SQL (–Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞)**

```sql
SELECT * FROM users WHERE age > 20 ORDER BY created_at DESC LIMIT 10;
INSERT INTO users(name, age) VALUES('Alice', 25);
UPDATE users SET age = 26 WHERE name = 'Alice';
DELETE FROM users WHERE name = 'Alice';
```

---

## üì¶ **4. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**

- `INTEGER`, `SERIAL`, `BIGINT`
- `TEXT`, `VARCHAR(n)`
- `BOOLEAN`
- `TIMESTAMP`, `DATE`
- `JSON`, `JSONB`
- `ARRAY`, `UUID`, `INET`

---

## üìö **5. –ò–Ω–¥–µ–∫—Å—ã**

- `CREATE INDEX idx_name ON users(name);`
- –í–∏–¥—ã:
  - B-Tree (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
  - GIN (–¥–ª—è JSONB / full-text)
  - GiST (–≥–µ–æ)
  - HASH (—Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

---

## üõ°Ô∏è **6. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ –∏–∑–æ–ª—è—Ü–∏—è**

```sql
BEGIN;
UPDATE accounts SET balance = balance - 100 WHERE id = 1;
COMMIT;
-- –∏–ª–∏ ROLLBACK;
```

**–£—Ä–æ–≤–Ω–∏ –∏–∑–æ–ª—è—Ü–∏–∏:**
- READ COMMITTED (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- REPEATABLE READ
- SERIALIZABLE

---

## üîÑ **7. –†–µ–ø–ª–∏–∫–∞—Ü–∏—è**

- **Streaming replication** ‚Äî –º–∞—Å—Ç–µ—Ä ‚Üí —Ä–µ–ø–ª–∏–∫–∞ —á–∏—Ç–∞–µ—Ç WAL
- **–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è**: –º–∞—Å—Ç–µ—Ä –∂–¥—ë—Ç —Ä–µ–ø–ª–∏–∫—É
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è**: –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç WAL
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **pg_basebackup** –∏–ª–∏ `repmgr`

---

## üÜò **8. Failover / HA**

- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
  - `Patroni` (–∫–ª–∞—Å—Ç–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ etcd/consul)
  - `pg_auto_failover`
  - `repmgr`
  - `HAProxy` ‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫—Ç–æ –º–∞—Å—Ç–µ—Ä
- –ü—Ä–∏ failover:
  - –°—Ç–∞—Ä–∞—è —Ä–µ–ø–ª–∏–∫–∞ ‚Üí —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–∞—Å—Ç–µ—Ä–æ–º
  - –î—Ä—É–≥–∏–µ —Ä–µ–ø–ª–∏–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è

---

## ‚öôÔ∏è **9. –ú–µ—Ö–∞–Ω–∏–∑–º—ã –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫**

- **Row-level lock** (`SELECT ... FOR UPDATE`)
- **Table-level lock**
- **Deadlocks** ‚Äî —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- `pg_locks` ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

---

## ‚ö° **10. Performance & Analyze**

- `EXPLAIN (ANALYZE)` ‚Äî –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞
- `VACUUM`, `ANALYZE`, `REINDEX`
- `autovacuum` ‚Äî –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ –º—É—Å–æ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–π –∏–Ω–¥–µ–∫—Å—ã –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ ‚Äî –æ–Ω–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ —É—Å–∫–æ—Ä—è—é—Ç

---

## üîé **11. JSON –∏ JSONB**

```sql
SELECT data->>'name' FROM users WHERE data->>'role' = 'admin';
```

- `JSON` ‚Äî –∫–∞–∫ –µ—Å—Ç—å
- `JSONB` ‚Äî –±–∏–Ω–∞—Ä–Ω—ã–π, –±—ã—Å—Ç—Ä–µ–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –∏–Ω–¥–µ–∫—Å–æ–≤
- –ò–Ω–¥–µ–∫—Å: `CREATE INDEX ON users USING gin(data);`

---

## üßÆ **12. –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ CTE**

**–û–∫–æ–Ω–Ω—ã–µ:**

```sql
SELECT name, age, RANK() OVER (ORDER BY age DESC) FROM users;
```

**CTE:**

```sql
WITH recent AS (
  SELECT * FROM orders WHERE created_at > now() - interval '7 days'
)
SELECT * FROM recent WHERE total > 100;
```

---

## üìä **13. –ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**

```sql
CREATE TABLE events (
  id serial, created_at date
) PARTITION BY RANGE (created_at);
```

- RANGE / LIST / HASH
- –£–ª—É—á—à–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –Ω–∞ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö

---

## üß™ **14. –†–∞—Å—à–∏—Ä–µ–Ω–∏—è**

```sql
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
CREATE EXTENSION pg_stat_statements;
```

–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ:
- `uuid-ossp`
- `pg_stat_statements` ‚Äî –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- `pg_trgm` ‚Äî –ø–æ–∏—Å–∫ –ø–æ –ø–æ—Ö–æ–∂–µ—Å—Ç–∏
- `PostGIS` ‚Äî –≥–µ–æ-–¥–∞–Ω–Ω—ã–µ

---

## üîê **15. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

- –†–æ–ª–∏ –∏ –ø—Ä–∏–≤–∏–ª–µ–≥–∏–∏: `GRANT`, `REVOKE`, `CREATE ROLE`
- `pg_hba.conf` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞ (host, user, –º–µ—Ç–æ–¥)
- `ALTER USER` —Å –ø–∞—Ä–æ–ª–µ–º
- SSL-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

---

## üõ†Ô∏è **16. –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã**

```bash
psql -U user -d dbname
\dt       -- —Å–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
\d users  -- —Å—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü—ã
\i file.sql  -- –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ñ–∞–π–ª
\q        -- –≤—ã—Ö–æ–¥
```

---

## üìà **17. Monitoring / Metrics**

- `pg_stat_activity` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏
- `pg_stat_user_tables`, `pg_stat_database`
- –ú–µ—Ç—Ä–∏–∫–∏ —á–µ—Ä–µ–∑:
  - `pg_stat_statements`
  - `pgBadger`
  - `Postgres Exporter` + Prometheus + Grafana

---

## üß† **18. –¢–∏–ø–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–±–µ—Å–µ**

- –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è? Sync vs Async?
- –ö–∞–∫ —Ä–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É split-brain?
- –ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ deadlock?
- –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç MVCC?
- –ß–µ–º JSON –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç JSONB?
- –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞?
- –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å HA?